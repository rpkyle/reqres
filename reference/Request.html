<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>HTTP Request Handling — Request • reqres</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="HTTP Request Handling — Request" />
<meta property="og:description" content="This class wraps all functionality related to extracting information from a
http request. Much of the functionality is inspired by the Request class in
Express.js, so the documentation
for this will complement this document. As reqres is build on top of the
Rook specifications
the Request object is initialized from a Rook-compliant object. This will
often be the request object provided by the httpuv framework. While it
shouldn't be needed, the original Rook object is always accessible and can be
modified, though any modifications will not propagate to derived values in
the Request object (e.g. changing the HTTP_HOST element of the Rook
object will not change the host field of the Request object). Because of
this, direct manipulation of the Rook object is generally discouraged." />
<meta property="og:image" content="https://reqres.data-imaginist.com/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reqres</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2017/introducing-reqres/">Version 0.2.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://fiery.data-imaginist.com">fiery</a>
</li>
<li>
  <a href="https://github.com/thomasp85/reqres">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>HTTP Request Handling</h1>
    <small class="dont-index">Source: <a href='https://github.com/thomasp85/reqres/blob/master/R/request.R'><code>R/request.R</code></a></small>
    <div class="hidden name"><code>Request.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class wraps all functionality related to extracting information from a
http request. Much of the functionality is inspired by the Request class in
Express.js, so <a href='https://expressjs.com/en/4x/api.html#req'>the documentation</a>
for this will complement this document. As <code>reqres</code> is build on top of the
<a href='https://github.com/jeffreyhorner/Rook/blob/a5e45f751/README.md'>Rook specifications</a>
the <code>Request</code> object is initialized from a Rook-compliant object. This will
often be the request object provided by the <code>httpuv</code> framework. While it
shouldn't be needed, the original Rook object is always accessible and can be
modified, though any modifications will not propagate to derived values in
the <code>Request</code> object (e.g. changing the <code>HTTP_HOST</code> element of the Rook
object will not change the <code>host</code> field of the <code>Request</code> object). Because of
this, direct manipulation of the Rook object is generally discouraged.</p>
    </div>

    <pre class="usage"><span class='fu'>as.Request</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='fu'>is.Request</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object coercible to a <code>Request</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Parameters passed on to <code>Request$new()</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>Request</code> object (for <code>as.Request()</code>) or a logical indicating whether
the object is a <code>Request</code> (for <code>is.Request()</code>)</p>
    <h2 class="hasAnchor" id="initialization"><a class="anchor" href="#initialization"></a>Initialization</h2>

    

<p>A new 'Request'-object is initialized using the <code>new()</code> method on the
generator:</p>
<p><strong>Usage</strong></p><table class='table'>
<tr><td><code>req &lt;- Request$new(rook, trust = FALSE)</code></td></tr>
</table>


<p><strong>Arguments</strong></p><table class='table'>
<tr><td><code>rook</code></td><td></td><td>The rook request that the new object should wrap</td></tr>
<tr><td><code>trust</code></td><td></td><td>Is this request trusted blindly. If <code>TRUE</code> <code>X-Forwarded-*</code> headers will be returned when querying host, ip, and protocol</td></tr>
</table>


    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    

<p>The following fields are accessible in a <code>Request</code> object:</p>
<dl class='dl-horizontal'>
<dt><code>trust</code></dt><dd><p>A logical indicating whether the request is trusted. <em>Mutable</em></p></dd>
<dt><code>method</code></dt><dd><p>A string indicating the request method (in lower case, e.g.
'get', 'put', etc.). <em>Immutable</em></p></dd>
<dt><code>body</code></dt><dd><p>An object holding the body of the request. This is an empty
string by default and needs to be populated using the <code>set_body()</code> method
(this is often done using a body parser that accesses the Rook$input
stream). <em>Immutable</em></p></dd>
<dt><code>cookies</code></dt><dd><p>Access a named list of all cookies in the request. These
have been URI decoded. <em>Immutable</em></p></dd>
<dt><code>headers</code></dt><dd><p>Access a named list of all headers in the request. In order
to follow R variable naming standards <code>-</code> have been substituted with <code>_</code>.
Use the <code>get_header()</code> method to lookup based on the correct header name.
<em>Immutable</em></p></dd>
<dt><code>host</code></dt><dd><p>Return the domain of the server given by the "Host" header if
<code>trust == FALSE</code>. If <code>trust == true</code> returns the <code>X-Forwarded-Host</code> instead.</p></dd>
<dt><code>ip</code></dt><dd><p>Returns the remote address of the request if <code>trust == FALSE</code>.
if <code>trust == TRUE</code> it will instead return the first value of the
<code>X-Forwarded-For</code> header. <em>Immutable</em></p></dd>
<dt><code>ips</code></dt><dd><p>If <code>trust == TRUE</code> it will return the full list of ips in the
<code>X-Forwarded-For</code> header. If <code>trust == FALSE</code> it will return an empty
vector. <em>Immutable</em></p></dd>
<dt><code>protocol</code></dt><dd><p>Returns the protocol (e.g. 'http') used for the request.
If <code>trust == TRUE</code> it will use the value of the <code>X-Forwarded-Proto</code> header.
<em>Immutable</em></p></dd>
<dt><code>root</code></dt><dd><p>The mount point of the application receiving this request. Can
be empty if the application is mounted on the server root. <em>Immutable</em></p></dd>
<dt><code>path</code></dt><dd><p>The part of the url following the root. Defines the local
target of the request (independent of where it is mounted). <em>Immutable</em></p></dd>
<dt><code>url</code></dt><dd><p>The full URL of the request. <em>Immutable</em></p></dd>
<dt><code>query</code></dt><dd><p>The query string of the request (anything following "?" in
the URL) parsed into a named list. The query has been url decoded and "+"
has been substituted with space. Multiple queries are expected to be
separated by either "&amp;" or "|". <em>Immutable</em></p></dd>
<dt><code>querystring</code></dt><dd><p>The unparsed query string of the request, including
"?". If no query string exists it will be <code>""</code> rather than <code>"?"</code></p></dd>
<dt><code>xhr</code></dt><dd><p>A logical indicating whether the <code>X-Requested-With</code> header
equals <code>XMLHttpRequest</code> thus indicating that the request was performed using
a JavaScript library such as jQuery. <em>Immutable</em></p></dd>
<dt><code>secure</code></dt><dd><p>A logical indicating whether the request was performed using
a secure connection, i.e. <code>protocol == 'https'</code>. <em>Immutable</em></p></dd>
<dt><code>origin</code></dt><dd><p>The original object used to create the <code>Request</code> object. As
<code>reqres</code> currently only works with rook this will always return the original
rook object. <em>Immutable</em>, though the content of the rook object itself might
be manipulated as it is an environment.</p></dd>
<dt><code>response</code></dt><dd><p>If a <code>Response</code> object has been created for this request
it is accessible through this field. <em>Immutable</em></p></dd>

</dl>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    

<p>The following methods are available in a <code>Request</code> object:</p>
<dl class='dl-horizontal'>
<dt><code>set_body(content)</code></dt><dd><p>Sets the content of the request body. This method
should mainly be used in concert with a body parser that reads the
<code>rook$input</code> stream</p></dd>
<dt><code>set_cookies(cookies)</code></dt><dd><p>Sets the cookies of the request. The cookies
are automatically parsed and populated, so this method is mainly available
to facilitate cookie signing and encryption</p></dd>
<dt><code>get_header(name)</code></dt><dd><p>Get the header of the specified name.</p></dd>
<dt><code>accepts(types)</code></dt><dd><p>Given a vector of response content types it returns
the preferred one based on the <code>Accept</code> header.</p></dd>
<dt><code>accepts_charsets(charsets)</code></dt><dd><p>Given a vector of possible character
encodings it returns the preferred one based on the <code>Accept-Charset</code>
header.</p></dd>
<dt><code>accepts_encoding(encoding)</code></dt><dd><p>Given a vector of possible content
encodings (usually compression algorithms) it selects the preferred one
based on the <code>Accept-Encoding</code> header. If there is no match it will return
<code>"identity"</code> signaling no compression.</p></dd>
<dt><code>accepts_language(language)</code></dt><dd><p>Given a vector of possible content
languages it selects the best one based on the <code>Accept-Language</code> header.</p></dd>
<dt><code>is(type)</code></dt><dd><p>Queries whether the body of the request is in a given
format by looking at the <code>Content-Type</code> header. Used for selecting the best
parsing method.</p></dd>
<dt><code>respond()</code></dt><dd><p>Creates a new <code>Response</code> object from the request</p></dd>
<dt><code><a href='https://rdrr.io/r/base/parse.html'>parse(..., autofail = TRUE)</a></code></dt><dd><p>Based on provided parsers it selects
the appropriate one by looking at the <code>Content-Type</code> header and assigns the
result to the request body. A parser is a function accepting a raw vector,
and a named list of additional directives,
and returns an R object of any kind (if the parser knows the input to be
plain text, simply wrap it in <code><a href='https://rdrr.io/r/base/rawConversion.html'>rawToChar()</a></code>). If the body is compressed, it
will be decompressed based on the <code>Content-Encoding</code> header prior to passing
it on to the parser. See <a href='parsers.html'>parsers</a> for a list of pre-supplied parsers.
Parsers are either supplied in a named list or as named arguments to the
parse method. The names should correspond to mime types or known file
extensions. If <code>autofail = TRUE</code> the response will be set with the correct
error code if parsing fails. <code><a href='https://rdrr.io/r/base/parse.html'>parse()</a></code> returns <code>TRUE</code> if parsing was
successful and <code>FALSE</code> if not</p></dd>
<dt><code>parse_raw(autofail = TRUE)</code></dt><dd><p>This is a simpler version of the
<code><a href='https://rdrr.io/r/base/parse.html'>parse()</a></code> method. It will attempt to decompress the body and set the <code>body</code>
field to the resulting raw vector. It is then up to the server to decide how
to handle the payload. It returns <code>TRUE</code> if successful and <code>FALSE</code>
otherwise.</p></dd>
<dt><code>as_message()</code></dt><dd><p>Prints a HTTP representation of the request to the
output stream.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Response.html'>Response</a></code> for handling http responses</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>fake_rook</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>fiery</span><span class='kw ns'>::</span><span class='fu'><a href='https://fiery.data-imaginist.com/reference/fake_request.html'>fake_request</a></span>(
  <span class='st'>'http://example.com/test?id=34632&amp;question=who+is+hadley'</span>,
  <span class='kw'>content</span> <span class='kw'>=</span> <span class='st'>'This is an elaborate ruse'</span>,
  <span class='kw'>headers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>Accept</span> <span class='kw'>=</span> <span class='st'>'application/json; text/*'</span>,
    <span class='kw'>Content_Type</span> <span class='kw'>=</span> <span class='st'>'text/plain'</span>
  )
)

<span class='no'>req</span> <span class='kw'>&lt;-</span> <span class='no'>Request</span>$<span class='fu'>new</span>(<span class='no'>fake_rook</span>)

<span class='co'># Get full URL</span>
<span class='no'>req</span>$<span class='no'>url</span></div><div class='output co'>#&gt; [1] "http://example.com:80/test?id=34632&amp;question=who+is+hadley"</div><div class='input'>
<span class='co'># Get list of query parameters</span>
<span class='no'>req</span>$<span class='no'>query</span></div><div class='output co'>#&gt; $id
#&gt; [1] 34632
#&gt; 
#&gt; $question
#&gt; [1] "who is hadley"
#&gt; </div><div class='input'>
<span class='co'># Test if content is text</span>
<span class='no'>req</span>$<span class='fu'>is</span>(<span class='st'>'txt'</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># Perform content negotiation for the response</span>
<span class='no'>req</span>$<span class='fu'>accepts</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'html'</span>, <span class='st'>'json'</span>, <span class='st'>'txt'</span>))</div><div class='output co'>#&gt; [1] "json"</div><div class='input'>
<span class='co'># Cleaning up connections</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span>(<span class='no'>fake_rook</span>, <span class='no'>req</span>)
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span>()</div><div class='output co'>#&gt;           used (Mb) gc trigger (Mb) max used (Mb)
#&gt; Ncells  774561 41.4    1224184 65.4  1224184 65.4
#&gt; Vcells 1491026 11.4    8388608 64.0  2496519 19.1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#initialization">Initialization</a></li>
      <li><a href="#fields">Fields</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://data-imaginist.com'>Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


