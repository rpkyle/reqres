<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>HTTP Response handling — Response • reqres</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="HTTP Response handling — Response" />
<meta property="og:description" content="This class handles all functionality involved in crafting a http response.
Much of the functionality is inspired by the Request class in Express.js, so
the documentation for this will
complement this document. As reqres is build on top of the
Rook specifications
the Response object can be converted to a compliant list object to be
passed on to e.g. the httpuv handler." />
<meta property="og:image" content="https://reqres.data-imaginist.com/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reqres</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2017/introducing-reqres/">Version 0.2.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://fiery.data-imaginist.com">fiery</a>
</li>
<li>
  <a href="https://github.com/thomasp85/reqres">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>HTTP Response handling</h1>
    <small class="dont-index">Source: <a href='https://github.com/thomasp85/reqres/blob/master/R/response.R'><code>R/response.R</code></a></small>
    <div class="hidden name"><code>Response.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class handles all functionality involved in crafting a http response.
Much of the functionality is inspired by the Request class in Express.js, so
<a href='https://expressjs.com/en/4x/api.html#res'>the documentation</a> for this will
complement this document. As <code>reqres</code> is build on top of the
<a href='https://github.com/jeffreyhorner/Rook/blob/a5e45f751/README.md'>Rook specifications</a>
the <code>Response</code> object can be converted to a compliant list object to be
passed on to e.g. the <code>httpuv</code> handler.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for Response</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='fu'>is.Response</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code>Response</code> object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Ignored</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A rook-compliant list-response (in case of <code><a href='https://rdrr.io/r/base/list.html'>as.list()</a></code>) or a logical
indicating whether the object is a <code>Response</code> (in case of <code>is.Response()</code>)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A <code>Response</code> object is always created
as a response to a <code>Request</code> object and contains a reference to the
originating <code>Request</code> object. A <code>Response</code> is always initialized with a
404 Not Found code, an empty string as body and the <code>Content-Type</code> header set
to <code>text/plain</code>. As the <code>Content-Type</code> header is required for <code>httpuv</code> to
function, it will be inferred if missing when converting to a list. If the
body is a raw vector it will be set to <code>application/octet-stream</code> and
otherwise it will be set to <code>text/plain</code>. It is always advised to consciously
set the <code>Content-Type</code> header though. The only exception is when attaching a
standard file where the type is inferred from the file extension
automatically. Unless the body is a raw vector it will automatically be
converted to a character vector and collapsed to a single string with <code>"\n"</code>
separating the individual elements before the <code>Response</code> object is converted
to a list (that is, the body can exist as any type of object up until the
moment where the <code>Response</code> object is converted to a list). To facilitate
communication between different middleware the <code>Response</code> object contains
a data store where information can be stored during the lifetime of the
response.</p>
    <h2 class="hasAnchor" id="initialization"><a class="anchor" href="#initialization"></a>Initialization</h2>

    

<p>A new 'Response'-object is initialized using the <code>new()</code> method on the
generator:</p>
<p><strong>Usage</strong></p><table class='table'>
<tr><td><code>res &lt;- Response$new(request)</code></td></tr>
</table>


<p>But often it will be provided by the request using the <code>respond()</code> method,
which will provide the response, creating one if it doesn't exist</p>
<p><strong>Usage</strong></p><table class='table'>
<tr><td><code>res &lt;- request$respond()</code></td></tr>
</table>


<p><strong>Arguments</strong></p><table class='table'>
<tr><td><code>request</code></td><td></td><td>The <code>Request</code> object that the <code>Response</code> is responding to</td></tr>
</table>


    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    

<p>The following fields are accessible in a <code>Response</code> object:</p>
<dl class='dl-horizontal'>
<dt><code>status</code></dt><dd><p>Gets or sets the status code of the response. Is initialised
with <code>404L</code></p></dd>
<dt><code>body</code></dt><dd><p>Set or get he body of the response. If it is a character
vector with a single element named <code>'file'</code> it will be interpreted as the
location of a file. It is better to use the <code>file</code> field for creating a
response referencing a file as it will automatically set the correct
headers.</p></dd>
<dt><code>file</code></dt><dd><p>Set or get the location of a file that should be used as the
body of the response. If the body is not referencing a file (but contains
something else) it will return <code>NULL</code>. The <code>Content-Type</code> header will
automatically be inferred from the file extension, if known. If unknown it
will defaults to <code>application/octet-stream</code>. If the file has no extension it
will be <code>text/plain</code>. Existence of the file will be checked.</p></dd>
<dt><code>type</code></dt><dd><p>Get or sets the <code>Content-Type</code> header of the response based on
a file extension or mime-type.</p></dd>
<dt><code>request</code></dt><dd><p>Get the original <code>Request</code> object that the object is
responding to.</p></dd>

</dl>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    

<p>The following methods are available in a <code>Response</code> object:</p>
<dl class='dl-horizontal'>
<dt><code>set_header(name, value)</code></dt><dd><p>Sets the header given by <code>name</code>. <code>value</code>
will be converted to character. A header will be added for each element in
<code>value</code>. Use <code>append_header()</code> for setting headers without overwriting
existing ones.</p></dd>
<dt><code>get_header(name)</code></dt><dd><p>Returns the header(s) given by <code>name</code></p></dd>
<dt><code>remove_header(name)</code></dt><dd><p>Removes all headers given by <code>name</code></p></dd>
<dt><code>has_header(name)</code></dt><dd><p>Test for the existence of any header given by
<code>name</code></p></dd>
<dt><code>append_header(name, value)</code></dt><dd><p>Adds an additional header given by
<code>name</code> with the value given by <code>value</code>. If the header does not exist yet it
will be created.</p></dd>
<dt><code>set_data(key, value)</code></dt><dd><p>Adds <code>value</code> to the internal data store and
stores it with <code>key</code></p></dd>
<dt><code>get_data(key)</code></dt><dd><p>Retrieves the data stored under <code>key</code> in the internal
data store.</p></dd>
<dt><code>remove_data(key)</code></dt><dd><p>Removes the data stored under <code>key</code> in the
internal data store.</p></dd>
<dt><code>has_data(key)</code></dt><dd><p>Queries whether the data store has an entry given by
<code>key</code></p></dd>
<dt><code><a href='https://rdrr.io/r/base/attach.html'>attach(file, filename=basename(file), type=NULL)</a></code></dt><dd><p>Sets the body to
the file given by <code>file</code> and marks the response as a download by setting the
<code>Content-Disposition</code> to <code>attachment; filename=&lt;filename&gt;</code>. Use the <code>type</code>
argument to overwrite the automatic type inference from the file extension.</p></dd>
<dt><code>status_with_text(code)</code></dt><dd><p>Sets the status to <code>code</code> and sets the body
to the associated status code description (e.g. <code>Bad Gateway</code> for <code>502L</code>)</p></dd>
<dt><code>set_cookie(name, value, encode = TRUE, expires = NULL, http_only = NULL, max_age = NULL, path = NULL, secure = NULL, same_site = NULL)</code></dt><dd><p>Adds
the cookie given by <code>name</code> to the given <code>value</code>, optionally url encoding it,
along with any additional directives. See
<a href='https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie'>https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie</a> for a
description of the different directives. If the cookie already exists it
will be overwritten. The validity of the directives will automatically be
checked. <code>expires</code> expects a POSIXct object, <code>http_only</code> and <code>secure</code> expect
a logical, <code>max_age</code> expects an integer, <code>path</code> a string, and <code>same_site</code>
either <code>"Lax"</code> or <code>"Strict"</code></p></dd>
<dt><code>remove_cookie(name)</code></dt><dd><p>Removes the cookie named <code>name</code> from the
response.</p></dd>
<dt><code>has_cookie(name)</code></dt><dd><p>Queries whether the response contains a cookie
named <code>name</code></p></dd>
<dt><code>set_links(...)</code></dt><dd><p>Sets the <code>Link</code> header based on the named arguments
passed to <code>...</code>. The names will be used for the <code>rel</code> directive.</p></dd>
<dt><code><a href='https://rdrr.io/r/base/format.html'>format(..., autofail = TRUE, compress = TRUE)</a></code></dt><dd><p>Based on the
formatters passed in through <code>...</code> content negotiation is performed with
request and the preferred formatter is chosen. The <code>Content-Type</code> header is
set automatically. If <code>compress = TRUE</code> the
<code>compress()</code> method will be called after formatting. If an error is
encountered and <code>autofail = TRUE</code> the response will be set to <code>500</code>. If a
formatter is not found and <code>autofail = TRUE</code> the response will be set to
<code>406</code>. If formatting is successful it will return <code>TRUE</code>, if not it will
return <code>FALSE</code></p></dd>
<dt><code>compress(priority = c('gzip', 'deflate', 'br', 'identity'))</code></dt><dd><p>Based
on the provided priority, an encoding is negotiated with the request and
applied. The <code>Content-Encoding</code> header is set to the chosen compression
algorithm.</p></dd>
<dt><code>content_length()</code></dt><dd><p>Calculates the length (in bytes) of the body.
This is the number that goes into the <code>Content-Length</code> header. Note that the
<code>Content-Length</code> header is set automatically by <code>httpuv</code> so this method
should only be called if the response size is needed for other reasons.</p></dd>
<dt><code>as_list()</code></dt><dd><p>Converts the object to a list for further processing by
a Rook compliant server such as <code>httpuv</code>. Will set <code>Content-Type</code> header if
missing and convert a non-raw body to a single character string.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Request.html'>Request</a></code> for handling http requests</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>fake_rook</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>fiery</span><span class='kw ns'>::</span><span class='fu'><a href='https://fiery.data-imaginist.com/reference/fake_request.html'>fake_request</a></span>(
  <span class='st'>'http://example.com/test?id=34632&amp;question=who+is+hadley'</span>,
  <span class='kw'>content</span> <span class='kw'>=</span> <span class='st'>'This is elaborate ruse'</span>,
  <span class='kw'>headers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>Accept</span> <span class='kw'>=</span> <span class='st'>'application/json; text/*'</span>,
    <span class='kw'>Content_Type</span> <span class='kw'>=</span> <span class='st'>'text/plain'</span>
  )
)

<span class='no'>req</span> <span class='kw'>&lt;-</span> <span class='no'>Request</span>$<span class='fu'>new</span>(<span class='no'>fake_rook</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>Response</span>$<span class='fu'>new</span>(<span class='no'>req</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; A HTTP response
#&gt; ===============
#&gt;         Status: 404 - Not Found
#&gt;   Content type: text/plain
#&gt; 
#&gt; In response to: http://example.com:80/test?id=34632&amp;question=who+is+hadley</div><div class='input'>
<span class='co'># Set the body to the associated status text</span>
<span class='no'>res</span>$<span class='fu'>status_with_text</span>(<span class='fl'>200L</span>)
<span class='no'>res</span>$<span class='no'>body</span></div><div class='output co'>#&gt; [1] "OK"</div><div class='input'>
<span class='co'># Infer Content-Type from file extension</span>
<span class='no'>res</span>$<span class='no'>type</span> <span class='kw'>&lt;-</span> <span class='st'>'json'</span>
<span class='no'>res</span>$<span class='no'>type</span></div><div class='output co'>#&gt; [1] "application/json"</div><div class='input'>
<span class='co'># Prepare a file for download</span>
<span class='no'>res</span>$<span class='fu'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'DESCRIPTION'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>'reqres'</span>))
<span class='no'>res</span>$<span class='no'>type</span></div><div class='output co'>#&gt; [1] "text/plain"</div><div class='input'><span class='no'>res</span>$<span class='no'>body</span></div><div class='output co'>#&gt;                                        file 
#&gt; "/home/travis/R/Library/reqres/DESCRIPTION" </div><div class='input'><span class='no'>res</span>$<span class='fu'>get_header</span>(<span class='st'>'Content-Disposition'</span>)</div><div class='output co'>#&gt; [1] "attachment; filename=DESCRIPTION"</div><div class='input'>
<span class='co'># Cleaning up connections</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span>(<span class='no'>fake_rook</span>, <span class='no'>req</span>, <span class='no'>res</span>)
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span>()</div><div class='output co'>#&gt;           used (Mb) gc trigger (Mb) max used (Mb)
#&gt; Ncells  790546 42.3    1509305 80.7  1224421 65.4
#&gt; Vcells 1522503 11.7    8388608 64.0  2492228 19.1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#initialization">Initialization</a></li>
      <li><a href="#fields">Fields</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://data-imaginist.com'>Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


